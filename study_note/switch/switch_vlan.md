# 交换机划分VLAN

## VLAN的基本概念
VLAN（Virtual Local Area Network）即虚拟局域网  
VLAN是一组设备和用户组成的逻辑子网，这些设备和用户并不受物理位置的限制，可以根据功能、部门及应用等因素将它们组织起来，相互之间的通信就好像它们在同一个网段中一样  
一个VLAN就是一个广播域，即广播帧是不能跨VLAN传播的  


## VLAN之间的通信
VLAN之间要实现相互通信，就需要通过路由器或三层交换机等设备  
1. 集中式路由策略
所有VLAN都通过一个中心路由器实现互联  
对于同一交换机（一般指二层交换机）上的两个端口，如果它们属于两个不同的VLAN  
尽管它们在同一交换机上，在数据交换时也要通过中心路由器来选择路由  
这种方式可能会受制于中心路由器的转发速度，造成网络拥堵  
2. 分布式路由策略
将路由选择功能适当地分布在带有路由功能的交换机上（即三层交换机）  
同一交换机上不同VLAN的端口可以直接实现互通  
这种方式具有极高的路由速度和良好的可伸缩性  


## VLAN与IP
一般来说，一个vlan占据一个c类网段，也就是254台主机  
一般来说，同一个VLAN中的设备，其IP地址都在一个网段  
例如，'192.168.1.2'和'192.168.2.1'属于不同的网段  


## 划分VLAN的作用
1. 由于广播包是不能跨网段的，所以一般采用划分VLAN的方式来抑制广播风暴的产生
2. 数据包只能在一个VLAN内传播，外部无法获取，增强了网络的安全性
3. VLAN可以将不同位置、不同用户任意组合到一起，增加了网络连接的灵活性


## 划分VLAN的方式
1. 基于交换机端口的VLAN(第7层物理层)
可以把一个交换机的多个端口或多个交换机的多个端口划分到一个VLAN中  
优点：配置过程简单明了，是最常用的一种方式  
缺点：网络设备对应的交换机或端口改变时，新端口也必须是原VLAN里的，否则要进行配置  
2. 基于MAC地址的VLAN(第6层数据链路层)
可以根据网络设备的MAC地址把多个网络设备划分到一个VLAN中  
优点：网络设备对应的交换机或端口改变时，不需要重新配置VLAN  
缺点：在设备入网时需要进行复杂的配置过程，尤其网络构建阶段的工作量很大  
3. 基于IP地址的VLAN(第5层网络层)
可以根据网络设备的IP地址把多个网络设备划分到一个VLAN中  
优点：在设备入网时无需进行较多的配置，设备改变时也不需要重新配置VLAN  
缺点：需要检查每个数据包的网络层地址(IP)，效率比较低  






VLAN的划分，可以在三层交换机上配置；也可以在网关设备/防火墙设备上进行配置。