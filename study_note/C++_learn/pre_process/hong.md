# 宏定义

## 预处理命令
为了提高编程效率，C/C++在编译之前增加了预处理步骤，主要包括：  
1. 宏定义命令
2. 文件包含命令
3. 条件编译命令
为了和一般的C/C++语句区别，预处理命令都以符号'#'开头  


## 常用命令
1. #define 定义一个预处理宏
2. #undef 取消宏的定义


## 不带参数的宏定义
**基本概念**
'#define'用一个指定的标识符来代表一个字符串  
将这个指定的标识符称为'宏名'  
将预处理时把宏名替换为字符串的过程称为'宏展开'  
```
# define PI 3.1415
# define SUM (1 + PI)

int main()
{
	cout << PI << endl;  \\3.1415
	cout << SUM << endl;  \\4.1415
}
```
**注意事项**
1. 宏名习惯上(非规定)全部用大写字母表示，以便与变量名区分
2. 宏展开只是做简单的字符串替换，不做任何正确性检查  
3. 宏定义命令不是C语句，不需要加分号  
4. 可以用'#undef 宏名'命令来终止宏定义的作用域  
5. 在进行宏定义时也可以引用已定义的宏名，做层层置换  
6. 程序代码中用双引号括起来的字符串，即使与宏同名，也不做置换  


## 带参数的宏定义
**基本概念**
带参数的宏定义不是进行简单的字符串替换，还要进行参数替换  
一般格式为：'# define 宏名 (参数表) 字符串'  
带参数的宏定义可以实现函数的功能，但不会对参数做正确性检查，很容易出错  
宏和函数是不同的，宏没有类型，也没有返回值的概念，参数也没有类型  
一般不用带参数的宏定义，而是用inline内联函数来替代  
```
# define PI 3.1415
# define S(r) PI * r * r
# define SUM(a, b, c) a + b * c

int main()
{
	cout << S(2) << endl;
	cout << SUM(1, 2, 3) << endl;
}
```
**注意事项**
1. 即使只有一个参数，也要用括号括起来
2. 宏定义时，宏名与左边的参数括号之间不能有空格，否则左侧都会被当成字符串
3. 宏替换不占用运行时间，只占编译时间


## 内联函数和宏定义的对比
**相同点**
1. 使用时都是直接替换，没有调用的开销，效率很高  
**不同点**
1. 内联函数是一个标准的函数，使用时会检查参数类型等  
但宏定义只是做简单的文本替换，不会检查参数类型，存在隐患  
2. 宏定义是编译前由预处理器对宏进行替换，内联函数是编译时由编译器来实现的  