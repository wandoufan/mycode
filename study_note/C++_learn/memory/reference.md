# 引用reference

## C++中的内存拷贝
参数的传递本质上是一次赋值的过程，赋值就是对内存进行拷贝  
对于char、bool、int、float等基本类型的数据，它们占用的内存往往只有几个字节，对它们进行内存拷贝非常快速  
对于数组、结构体、对象等复合类型数据，数据有可能会非常大，对它们进行频繁的内存拷贝可能会消耗很多时间，拖慢程序的执行效率  
C/C++禁止在函数调用时直接传递数组的内容，而是强制传递数组指针  
对于结构体和对象没有这种限制，调用函数时既可以传递指针，也可以直接传递内容  


## 基本概念
引用（Reference）是C++相对于C语言的又一个扩充，即C语言中没有引用  
引用是一种比指针更加便捷的传递复合类型数据的方式  
引用可以看做是数据的一个别名，通过这个别名和原来的名字都能够找到这份数据  


## 使用方式
引用的定义方式类似于指针，只是用&取代了\*  
语法格式为：'type &name = data;'  
其中，type是被引用数据的类型，name是引用的名称，data是被引用的数据  
引用必须在定义的同时初始化，并且以后也要从一而终，不能再引用其它数据  
```
int a = 1;
int &r = a; //r是对a的引用，二者值相同，内存地址也相同
cout << r << endl; //输出r的值：1
cout << &r << endl; //输出r的内存地址：0x22fe44
```
和指针类似，引用r和变量a都是指向同一个内存地址，因此修改r的值就是修改a的值  


## 引用和指针的区别
1. 不存在空引用，引用必须连接到一块合法的内存  
2. 一旦引用被初始化为一个对象，就不能被指向到另一个对象，而指针可以在任何时候指向到另一个对象  
3. 引用必须在创建时被初始化，而指针可以在任何时间被初始化  


## 引用作为函数参数
把引用作为参数传给函数，这比传一般的参数更安全  
```
//指针和引用的功能类似，都可以在函数内部修改外部的数据
void swap1(int *p1, int *p2) //传递指针
{
    int temp = *p1;
    *p1 = *p2;
    *p2 = temp;
}
void swap2(int &r1, int &r2) //按引用传参
{
    int temp = r1;
    r1 = r2;
    r2 = temp;
}
```


## 引用作为函数返回值
函数返回值通过使用引用来替代指针，会使C++程序更容易阅读和维护  
当函数返回一个引用时，则返回一个指向返回值的隐式指针  
注意：返回值类型必须也是用&修饰的引用类型  
```
int &add(int &a) //用&修饰函数名，表示返回一个引用类型
{
	a += 1;
	return a;
}

int main()
{
	int num1 = 10;
	int num2 = add(num1);
	cout << num1 << endl; //11
	cout << num2 << endl; //11
}
```
注意：引用作为函数返回值时，不能返回函数中的局部变量  
```
int &add(int &a)
{
	int b;
	b = a + 1;
	return b; //b是局部变量，返回b会产生问题
}
```