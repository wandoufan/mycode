# 卷积神经网络(Convolutional Neural Networks, CNN)


## 参考资料
> https://blog.csdn.net/weixin_42137700/article/details/90644473
> https://zhuanlan.zhihu.com/p/25249694
> https://www.jianshu.com/p/70b6f5653ac6

## 基本概念
卷积神经网络是一类包含卷积计算且具有深度结构的前馈神经网络，是深度学习的代表算法之一  


## 应用场景
1. CNN的经典用例是执行图像分类，例如查看宠物的图像并判断它是猫还是狗  
2. CNN执行文本分类任务，即TextCNN  
文本和图片不一样，图片有长宽和深度(RGB)，对应到文本上，假设文本有m个词，每个词的向量维度为n  
则输入向量有m x n x 1个特征，其中深度可以看为1  


## CNN对传统神经网络的改进
1. 传统神经网络的缺点  
使用传统神经网络来处理一张224x224的彩色图像，包括图像中的3个彩色通道(RGB)，输入向量有224×224×3=150528个特征  
在这样的网络中，一个典型的隐藏层可能有1024个节点，因此我们必须为第一层单独训练150528 x 1024 = 约1.5亿个权重  
因此使用传统神经网络会非常巨大，几乎没有办法进行训练  
2. CNN的改进  
对于图像数据，图像中的物体是由小的局部特征组成的，即像素在相邻的上下文中是最有用的  
因此对于图像处理来说，第一个隐藏层也不需要每个节点都去处理图片上的所有像素  
每个节点可以只连接输入单元的一部分，这样一来每层需要处理的连接和权重就大大减少了  
例如，每个节点只连接到它对应位置周围 3 x 3 范围内的值，每个连接分别设置权值  
特别的，如果对应位置在图像边缘，则边缘外的连接权重设为0  


## CNN的特点
1. CNN不是全连接的  


## 卷积层、池化层和全连接层
卷积神经网络的隐藏层包含卷积层、池化层和全连接层3类常见构筑，其中卷积层和池化层为卷积神经网络特有  
3类常见构筑在隐藏层中的顺序通常为：输入-卷积层-池化层-全连接层-输出  
1. 卷积层(convolutional layer)-特征提取  
卷积层的功能是对输入数据进行特征提取，其内部包含多个卷积核，卷积核一般从左到右/从上到下的顺序进行特征抽取  
组成卷积核的每个元素都对应一个权重系数和一个偏差量（bias vector），类似于一个前馈神经网络的神经元  
例如，输入图像是7 x 7的，卷积核是3 x 3的，步长为1，输出的特征提取图像就是5 x 5的  
上述操作其实就是对数字图像进行离散卷积操作(实质是矩阵相乘运算)，又叫滤波  
卷积核也可以称为滤波器，上面的3 x 3就是一个滤波器  
卷积层中包含激励函数ReLU以协助表达复杂特征  

2. 池化层(pooling layer)-特征选择  
在卷积层进行特征提取后会得到维度很大的特征，输出的特征图会被传递至池化层进行特征选择和信息过滤  
池化层通过将特征切成几个区域，取其最大值或平均值，得到新的、维度较小的特征  
按照池化取值的不同可以分为均值池化层和最大值池化层，一般更多的使用最大池化层  
最常用的池化层是2 x 2的，步长为2，取输入图像的4个像素的最大值作为输出值  
例如，输入图像是4 x 4的，池化层是2 x 2的，步长为2，输出的图像就是2 x 2的  
池化的好处：  
2.1 降低了过拟合的风险  
例如，feature map = [1, 1, 2] 或者[1, 0, 2] 最后的输出都是[2]，表明开始的输入即使有轻微变形也不影响最后的识别  
2.2 减少了网络的参数和计算次数，从而缩短训练时间  

3. 全连接层(fully-connected layer)-类别判断  
全连接层把所有局部特征结合变成全局特征，用来计算每一类的得分，即图片属于某类的概率  
全连接层相当于一个分类器，将特征映射到样本标记空间，本质上属于矩阵变换  
例如，输入图像是3 x 3的，可以展开为9 x 1，每行都代表一个类别  


## 卷积层的超参数
卷积层超参数包括卷积核大小、步长和填充，三者共同决定了卷积层输出特征图的尺寸  
1. 卷积核大小  
卷积核大小可以指定为小于输入图像尺寸的任意值，例如上面的3 x 3  
一般卷积核越大，可以提取的输入特征就越复杂  
2. 卷积步长  
卷积步长定义了卷积核移动的步长，步幅大小通常为1，意味着滤镜逐个像素地滑动  
卷积步长为1时，卷积核会逐个扫过特征图的元素，步长为n时会在下一次扫描跳过n-1个像素  
3. 填充/补零  
由于输出的特征提取图像始终是小于输入图像的，为了防止图像不断缩小，我们要对图像进行填充  
填充一般添加一层零值像素环绕到输出图像的周围  


## 池化层的超参数
池化层选取池化区域与卷积核扫描特征图步骤相同，由池化大小、步长和填充控制  
这些概念与卷积层的概念基本相同  


## 常见CNN
1. TextCNN


## CNN和RNN的比较
1. 处理的数据  
CNN主要处理图像，RNN主要处理视频、音频、文本等序列化数据  
2. 扩展方式  
CNN在空间上进行扩展，RNN在时间上进行扩展  
3. 连接方式  
RNN是全连接的，CNN不是全连接的  
4. 输出方式  
RNN是具有记忆功能的连续输出，而CNN是静态输出  
5. NLP应用  
RNN可以用来做词性标注，CNN可以用来做文本分类  
